% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create.R
\name{schtask_create_monthly}
\alias{schtask_create_monthly}
\title{Create a scheduled task that runs monthly}
\usage{
schtask_create_monthly(
  task_name,
  task_run,
  modifier = 1L,
  day = NULL,
  months = "*",
  script = file.path(Sys.getenv("R_HOME"), "bin", "Rscript.exe"),
  exec_path = here::here(),
  start_time = NULL,
  start_date = NULL,
  end_date = NULL,
  run_level = "LIMITED",
  run_as_user = NULL,
  delete_when_done = FALSE,
  force = FALSE,
  interactive_only = FALSE
)
}
\arguments{
\item{task_name}{Character string. Name of the task (max 238 characters).}

\item{task_run}{Character string. The program, script, or command to run.
Can be an absolute path (e.g., \code{"C:/Scripts/script.R"}), a relative path
(e.g., \code{"script.R"} or \code{"subfolder/script.R"}, interpreted relative to \code{exec_path}),
or an executable name on PATH (e.g., \code{"notepad.exe"}).}

\item{modifier}{Either an integer (1-12) specifying to run every N months,
or a character string: \code{"FIRST"}, \code{"SECOND"}, \code{"THIRD"}, \code{"FOURTH"},
\code{"LAST"} (for week-of-month scheduling), or \code{"LASTDAY"} (for last day of month).
Default is 1 (every month).}

\item{day}{Day specification. The meaning depends on \code{modifier}:
\itemize{
\item If \code{modifier} is numeric: day of the month (1-31). Default is 1.
\item If \code{modifier} is \code{"FIRST"}, \code{"SECOND"}, \code{"THIRD"}, \code{"FOURTH"}, or \code{"LAST"}:
day of the week (\code{"MON"}, \code{"TUE"}, etc.). Required in this case.
\item If \code{modifier} is \code{"LASTDAY"}: not used (a warning is issued if provided).
}}

\item{months}{Character vector of months when the task should run.
Valid values: \code{"JAN"}, \code{"FEB"}, \code{"MAR"}, \code{"APR"}, \code{"MAY"}, \code{"JUN"},
\code{"JUL"}, \code{"AUG"}, \code{"SEP"}, \code{"OCT"}, \code{"NOV"}, \code{"DEC"}, or \code{"*"} for all months.
Full month names are also accepted. Default is \code{"*"} (all months).}

\item{script}{Character string or NULL. Path to script interpreter executable.
Can be an absolute path (e.g., \code{"C:/Python311/python.exe"}), a relative path
(interpreted relative to \code{exec_path}), or an executable name on PATH
(e.g., \code{"python"}). If \code{NULL}, runs \code{task_run} directly via cmd.exe.
Default is Rscript.exe from the current R installation.}

\item{exec_path}{Character string. Directory from which to execute the task.
Relative paths in \code{task_run} and \code{script} are interpreted relative to this
directory. The path is automatically expanded (e.g., \code{~} becomes the user's
home directory). Default is \code{here::here()} (project root).}

\item{start_time}{Character string. Start time in HH:MM 24-hour format.
If \code{NULL} (default), the task starts immediately.}

\item{start_date}{Date or character string. Date when the schedule starts.
If \code{NULL}, uses current date.}

\item{end_date}{Date or character string. Date when the schedule ends. Optional.}

\item{run_level}{Character string. Either \code{"LIMITED"} (default, runs with
standard user privileges) or \code{"HIGHEST"} (runs with elevated privileges).}

\item{run_as_user}{Character string. User account under which the task runs.
If \code{NULL}, runs as the current user. Use \code{"SYSTEM"} for system account.}

\item{delete_when_done}{Logical. If \code{TRUE}, deletes the task after it completes.
Default is \code{FALSE}.}

\item{force}{Logical. If \code{TRUE}, suppresses warnings if the task already exists
and overwrites it. Default is \code{FALSE}.}

\item{interactive_only}{Logical. If \code{TRUE}, the task only runs when the
\code{run_as_user} is logged on. Default is \code{FALSE}.}
}
\value{
Invisibly returns \code{TRUE} on success.
}
\description{
Creates a task that runs on a monthly schedule. The schedule can be configured
in several ways:
}
\details{
\itemize{
\item \strong{Every N months on a specific day of the month}: Set \code{modifier} to a number
(1-12) and \code{day} to the day of the month (1-31).
\item \strong{On a specific week and day of the month}: Set \code{modifier} to \code{"FIRST"},
\code{"SECOND"}, \code{"THIRD"}, \code{"FOURTH"}, or \code{"LAST"}, and \code{day} to a day of the week.
\item \strong{On the last day of the month}: Set \code{modifier} to \code{"LASTDAY"}.
}
}
\examples{
\dontrun{
# Run on the 15th of every month
schtask_create_monthly(
  task_name = "MidMonthReport",
  task_run = "report.R",
  day = 15,
  start_time = "09:00"
)

# Run on the second Tuesday of every month
schtask_create_monthly(
  task_name = "SecondTuesday",
  task_run = "meeting.R",
  modifier = "SECOND",
  day = "TUE",
  start_time = "10:00"
)

# Run on the last day of every month
schtask_create_monthly(
  task_name = "MonthEnd",
  task_run = "close.R",
  modifier = "LASTDAY",
  start_time = "18:00"
)

# Run every 3 months on the 1st
schtask_create_monthly(
  task_name = "QuarterlyReview",
  task_run = "review.R",
  modifier = 3,
  day = 1,
  start_time = "09:00"
)

# Run on the first Monday of March and September
schtask_create_monthly(
  task_name = "BiAnnualKickoff",
  task_run = "kickoff.R",
  modifier = "FIRST",
  day = "MON",
  months = c("MAR", "SEP"),
  start_time = "09:00"
)
}
}
